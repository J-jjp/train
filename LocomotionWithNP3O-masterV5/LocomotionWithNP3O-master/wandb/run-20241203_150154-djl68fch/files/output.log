ppo with teacher actor
no imitation
MixedMlpBarlowTwinsActor(
  (mlp_encoder): Sequential(
    (0): Linear(in_features=225, out_features=512, bias=True)
    (1): ELU(alpha=1.0)
    (2): Linear(in_features=512, out_features=256, bias=True)
    (3): ELU(alpha=1.0)
    (4): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (5): Linear(in_features=256, out_features=128, bias=True)
    (6): ELU(alpha=1.0)
    (7): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (8): Linear(in_features=128, out_features=23, bias=True)
  )
  (actor): MixedMlp(
    (gate): Sequential(
      (0): Linear(in_features=68, out_features=128, bias=True)
      (1): ELU(alpha=1.0)
      (2): Linear(in_features=128, out_features=128, bias=True)
      (3): ELU(alpha=1.0)
      (4): Linear(in_features=128, out_features=4, bias=True)
    )
  )
  (obs_encoder): Sequential(
    (0): Linear(in_features=45, out_features=256, bias=True)
    (1): ELU(alpha=1.0)
    (2): Linear(in_features=256, out_features=128, bias=True)
    (3): ELU(alpha=1.0)
    (4): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (5): Linear(in_features=128, out_features=16, bias=True)
  )
  (bn): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
)
running with imi loss off
num_transitions_per_env: 24
cost_shape: [9]
################################################################################
                      [1m Learning iteration 0/6000 
                       Computation: 5162 steps/s (collection: 4.056s, learning 0.705s)
               Value function loss: 0.00144
          cost value function loss: 0.43768
                    Surrogate loss: -0.01687
                         viol loss: 0.00000
             Mean action noise std: 1.00
                       Mean reward: 0.00
               Mean episode length: 4.04
      Mean episode rew_action_rate: -0.00081
Mean episode rew_action_smoothness: -0.00176
       Mean episode rew_ang_vel_xy: -0.00368
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00094
    Mean episode rew_feet_air_time: -0.00162
Mean episode rew_feet_contact_forces: -0.00005
   Mean episode rew_foot_clearance: -0.00009
        Mean episode rew_foot_slip: -0.00051
          Mean episode rew_hip_pos: -0.00005
        Mean episode rew_lin_vel_z: -0.00044
        Mean episode rew_low_speed: -0.00073
Mean episode rew_orientation_eular: 0.00025
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00048
 Mean episode rew_tracking_ang_vel: 0.00052
 Mean episode rew_tracking_lin_vel: 0.00303
 Mean episode rew_vel_mismatch_exp: 0.00038
  Mean episode cost_acc_smoothness: 0.03538
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00126
  Mean episode cost_dof_vel_limits: 0.00002
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00009
       Mean episode cost_pos_limit: 0.00001
     Mean episode cost_stand_still: 0.00031
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.76s
                       Mean reward: 0.00
                      [1m Learning iteration 0/6000 
################################################################################
                      [1m Learning iteration 1/6000 
                       Computation: 5575 steps/s (collection: 3.889s, learning 0.519s)
               Value function loss: 0.00013
          cost value function loss: 0.26122
                    Surrogate loss: -0.01572
                         viol loss: 0.00000
             Mean action noise std: 0.99
                       Mean reward: 0.00
               Mean episode length: 4.02
      Mean episode rew_action_rate: -0.00092
Mean episode rew_action_smoothness: -0.00201
       Mean episode rew_ang_vel_xy: -0.00375
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00103
    Mean episode rew_feet_air_time: -0.00173
Mean episode rew_feet_contact_forces: -0.00006
   Mean episode rew_foot_clearance: -0.00010
        Mean episode rew_foot_slip: -0.00052
          Mean episode rew_hip_pos: -0.00005
        Mean episode rew_lin_vel_z: -0.00049
        Mean episode rew_low_speed: -0.00076
Mean episode rew_orientation_eular: 0.00025
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00051
 Mean episode rew_tracking_ang_vel: 0.00054
 Mean episode rew_tracking_lin_vel: 0.00319
 Mean episode rew_vel_mismatch_exp: 0.00039
  Mean episode cost_acc_smoothness: 0.04037
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00127
  Mean episode cost_dof_vel_limits: 0.00003
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00010
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00026
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.41s
                       Mean reward: 0.00
                      [1m Learning iteration 1/6000 
################################################################################
                      [1m Learning iteration 2/6000 
                       Computation: 5474 steps/s (collection: 3.917s, learning 0.572s)
               Value function loss: 0.00004
          cost value function loss: 0.24768
                    Surrogate loss: -0.01972
                         viol loss: 0.00000
             Mean action noise std: 0.97
                       Mean reward: 0.00
               Mean episode length: 4.08
      Mean episode rew_action_rate: -0.00092
Mean episode rew_action_smoothness: -0.00202
       Mean episode rew_ang_vel_xy: -0.00379
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00104
    Mean episode rew_feet_air_time: -0.00173
Mean episode rew_feet_contact_forces: -0.00006
   Mean episode rew_foot_clearance: -0.00010
        Mean episode rew_foot_slip: -0.00053
          Mean episode rew_hip_pos: -0.00005
        Mean episode rew_lin_vel_z: -0.00048
        Mean episode rew_low_speed: -0.00074
Mean episode rew_orientation_eular: 0.00025
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00052
 Mean episode rew_tracking_ang_vel: 0.00054
 Mean episode rew_tracking_lin_vel: 0.00323
 Mean episode rew_vel_mismatch_exp: 0.00039
  Mean episode cost_acc_smoothness: 0.04105
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00125
  Mean episode cost_dof_vel_limits: 0.00003
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00010
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00029
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.49s
                       Mean reward: 0.00
                      [1m Learning iteration 2/6000 
################################################################################
                      [1m Learning iteration 3/6000 
                       Computation: 5495 steps/s (collection: 3.952s, learning 0.520s)
               Value function loss: 0.00003
          cost value function loss: 0.22640
                    Surrogate loss: -0.01553
                         viol loss: 0.00000
             Mean action noise std: 0.95
                       Mean reward: 0.00
               Mean episode length: 3.52
      Mean episode rew_action_rate: -0.00092
Mean episode rew_action_smoothness: -0.00205
       Mean episode rew_ang_vel_xy: -0.00378
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00106
    Mean episode rew_feet_air_time: -0.00179
Mean episode rew_feet_contact_forces: -0.00007
   Mean episode rew_foot_clearance: -0.00011
        Mean episode rew_foot_slip: -0.00055
          Mean episode rew_hip_pos: -0.00005
        Mean episode rew_lin_vel_z: -0.00051
        Mean episode rew_low_speed: -0.00080
Mean episode rew_orientation_eular: 0.00026
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00053
 Mean episode rew_tracking_ang_vel: 0.00058
 Mean episode rew_tracking_lin_vel: 0.00337
 Mean episode rew_vel_mismatch_exp: 0.00041
  Mean episode cost_acc_smoothness: 0.04107
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00126
  Mean episode cost_dof_vel_limits: 0.00002
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00010
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00036
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.47s
                       Mean reward: 0.00
                      [1m Learning iteration 3/6000 
################################################################################
                      [1m Learning iteration 4/6000 
                       Computation: 5576 steps/s (collection: 3.887s, learning 0.521s)
               Value function loss: 0.00002
          cost value function loss: 0.24246
                    Surrogate loss: -0.01985
                         viol loss: 0.00000
             Mean action noise std: 0.93
                       Mean reward: 0.00
               Mean episode length: 3.97
      Mean episode rew_action_rate: -0.00094
Mean episode rew_action_smoothness: -0.00211
       Mean episode rew_ang_vel_xy: -0.00378
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00110
    Mean episode rew_feet_air_time: -0.00190
Mean episode rew_feet_contact_forces: -0.00007
   Mean episode rew_foot_clearance: -0.00011
        Mean episode rew_foot_slip: -0.00058
          Mean episode rew_hip_pos: -0.00006
        Mean episode rew_lin_vel_z: -0.00052
        Mean episode rew_low_speed: -0.00084
Mean episode rew_orientation_eular: 0.00027
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00055
 Mean episode rew_tracking_ang_vel: 0.00060
 Mean episode rew_tracking_lin_vel: 0.00353
 Mean episode rew_vel_mismatch_exp: 0.00043
  Mean episode cost_acc_smoothness: 0.04366
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00129
  Mean episode cost_dof_vel_limits: 0.00003
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00011
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00032
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.41s
                       Mean reward: 0.00
                      [1m Learning iteration 4/6000 
################################################################################
                      [1m Learning iteration 5/6000 
                       Computation: 5448 steps/s (collection: 3.986s, learning 0.525s)
               Value function loss: 0.00002
          cost value function loss: 0.24329
                    Surrogate loss: -0.01562
                         viol loss: 0.00000
             Mean action noise std: 0.92
                       Mean reward: 0.00
               Mean episode length: 4.54
      Mean episode rew_action_rate: -0.00093
Mean episode rew_action_smoothness: -0.00212
       Mean episode rew_ang_vel_xy: -0.00382
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00112
    Mean episode rew_feet_air_time: -0.00193
Mean episode rew_feet_contact_forces: -0.00007
   Mean episode rew_foot_clearance: -0.00012
        Mean episode rew_foot_slip: -0.00059
          Mean episode rew_hip_pos: -0.00006
        Mean episode rew_lin_vel_z: -0.00054
        Mean episode rew_low_speed: -0.00086
Mean episode rew_orientation_eular: 0.00028
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00057
 Mean episode rew_tracking_ang_vel: 0.00063
 Mean episode rew_tracking_lin_vel: 0.00368
 Mean episode rew_vel_mismatch_exp: 0.00045
  Mean episode cost_acc_smoothness: 0.04355
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00129
  Mean episode cost_dof_vel_limits: 0.00003
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00012
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00042
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.51s
                       Mean reward: 0.00
                      [1m Learning iteration 5/6000 
################################################################################
                      [1m Learning iteration 6/6000 
                       Computation: 5559 steps/s (collection: 3.896s, learning 0.524s)
               Value function loss: 0.00006
          cost value function loss: 0.22096
                    Surrogate loss: -0.01684
                         viol loss: 0.00000
             Mean action noise std: 0.90
                       Mean reward: 0.00
               Mean episode length: 4.81
      Mean episode rew_action_rate: -0.00092
Mean episode rew_action_smoothness: -0.00211
       Mean episode rew_ang_vel_xy: -0.00377
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00111
    Mean episode rew_feet_air_time: -0.00203
Mean episode rew_feet_contact_forces: -0.00007
   Mean episode rew_foot_clearance: -0.00012
        Mean episode rew_foot_slip: -0.00063
          Mean episode rew_hip_pos: -0.00006
        Mean episode rew_lin_vel_z: -0.00053
        Mean episode rew_low_speed: -0.00087
Mean episode rew_orientation_eular: 0.00029
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00060
 Mean episode rew_tracking_ang_vel: 0.00063
 Mean episode rew_tracking_lin_vel: 0.00379
 Mean episode rew_vel_mismatch_exp: 0.00047
  Mean episode cost_acc_smoothness: 0.04125
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00131
  Mean episode cost_dof_vel_limits: 0.00002
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00012
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00042
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.42s
                       Mean reward: 0.00
                      [1m Learning iteration 6/6000 
################################################################################
                      [1m Learning iteration 7/6000 
                       Computation: 5272 steps/s (collection: 4.086s, learning 0.576s)
               Value function loss: 0.00003
          cost value function loss: 0.21480
                    Surrogate loss: -0.01545
                         viol loss: 0.00000
             Mean action noise std: 0.89
                       Mean reward: 0.01
               Mean episode length: 4.90
      Mean episode rew_action_rate: -0.00094
Mean episode rew_action_smoothness: -0.00219
       Mean episode rew_ang_vel_xy: -0.00382
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00003
          Mean episode rew_dof_acc: -0.00116
    Mean episode rew_feet_air_time: -0.00205
Mean episode rew_feet_contact_forces: -0.00007
   Mean episode rew_foot_clearance: -0.00013
        Mean episode rew_foot_slip: -0.00065
          Mean episode rew_hip_pos: -0.00007
        Mean episode rew_lin_vel_z: -0.00055
        Mean episode rew_low_speed: -0.00092
Mean episode rew_orientation_eular: 0.00030
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00062
 Mean episode rew_tracking_ang_vel: 0.00068
 Mean episode rew_tracking_lin_vel: 0.00396
 Mean episode rew_vel_mismatch_exp: 0.00049
  Mean episode cost_acc_smoothness: 0.04404
     Mean episode cost_base_height: 0.00003
       Mean episode cost_collision: 0.00131
  Mean episode cost_dof_vel_limits: 0.00003
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00013
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00042
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.66s
                       Mean reward: 0.01
                      [1m Learning iteration 7/6000 
################################################################################
                      [1m Learning iteration 8/6000 
                       Computation: 5571 steps/s (collection: 3.882s, learning 0.529s)
               Value function loss: 0.00002
          cost value function loss: 0.23425
                    Surrogate loss: -0.01432
                         viol loss: 0.00000
             Mean action noise std: 0.88
                       Mean reward: 0.01
               Mean episode length: 5.21
      Mean episode rew_action_rate: -0.00097
Mean episode rew_action_smoothness: -0.00226
       Mean episode rew_ang_vel_xy: -0.00385
         Mean episode rew_base_acc: -0.00000
      Mean episode rew_base_height: -0.00004
          Mean episode rew_dof_acc: -0.00121
    Mean episode rew_feet_air_time: -0.00221
Mean episode rew_feet_contact_forces: -0.00007
   Mean episode rew_foot_clearance: -0.00014
        Mean episode rew_foot_slip: -0.00068
          Mean episode rew_hip_pos: -0.00007
        Mean episode rew_lin_vel_z: -0.00058
        Mean episode rew_low_speed: -0.00095
Mean episode rew_orientation_eular: 0.00031
           Mean episode rew_powers: -0.00002
      Mean episode rew_stand_still: -0.00000
   Mean episode rew_track_vel_hard: -0.00065
 Mean episode rew_tracking_ang_vel: 0.00072
 Mean episode rew_tracking_lin_vel: 0.00416
 Mean episode rew_vel_mismatch_exp: 0.00051
  Mean episode cost_acc_smoothness: 0.04700
     Mean episode cost_base_height: 0.00004
       Mean episode cost_collision: 0.00131
  Mean episode cost_dof_vel_limits: 0.00003
   Mean episode cost_feet_air_time: 0.00000
         Mean episode cost_hip_pos: 0.00014
       Mean episode cost_pos_limit: 0.00002
     Mean episode cost_stand_still: 0.00031
    Mean episode cost_torque_limit: 0.00000
--------------------------------------------------------------------------------
                    Iteration time: 4.41s
                       Mean reward: 0.01
                      [1m Learning iteration 8/6000 
Traceback (most recent call last):
  File "train.py", line 29, in <module>
    train(args)
  File "train.py", line 19, in train
    ppo_runner.learn(num_learning_iterations=train_cfg.runner.max_iterations, init_at_random_ep_len=True)
  File "/home/jiaojunpeng/isaac/LocomotionWithNP3O-masterV5/LocomotionWithNP3O-master/runner/on_constraint_policy_runner.py", line 147, in learn
    obs, privileged_obs, rewards,costs,dones, infos = self.env.step(actions)  # obs has changed to next_obs !! if done obs has been reset
  File "/home/jiaojunpeng/isaac/LocomotionWithNP3O-masterV5/LocomotionWithNP3O-master/envs/legged_robot.py", line 374, in step
    self.render()
  File "/home/jiaojunpeng/isaac/LocomotionWithNP3O-masterV5/LocomotionWithNP3O-master/envs/base_task.py", line 180, in render
    self.gym.draw_viewer(self.viewer, self.sim, True)
KeyboardInterrupt